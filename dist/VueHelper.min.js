!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(n=n||self,n.VueHelper=t())}(this,function(){"use strict";function n(n){return n&&"object"==typeof n&&n.length>=0}function t(n){return n&&"function"==typeof n}function i(n){return n&&"object"==typeof n&&!n.length}function e(e,o){var r=!0;if(e&&t(o)){if(n(e))for(var u=0;u<e.length&&(void 0===(r=o(e[u],u))||!1!==r);u++);if(i(e)){var s=0;for(var f in e)if(void 0!==(r=o(e[f],f,s++))&&!1===r)break}}}function o(n,t){if(!n||!t)return n;for(var i=n,e=String(t).split("."),o=0;o<e.length&&(i=i[e[o]]);o++);return i}function r(n){return n?i(n)?function(n){return"object"==typeof n?Object.keys(n):[]}(n).length:n.length:0}function u(u){function s(s,f){function c(n){return l.indexOf(n)>-1}function h(n,t){f[n]=new u(function(n,t,i){var o={};return i?e(n,function(n,i){t.indexOf(i)<0&&(o[i]=n)}):e(t,function(t){o[t]=n[t]}),o}(t,["watch"],!0)),p[n]=o(t,"watch");var i=r(o(f[n],"$options.services"))+1;a[n][i].__proto__=f[n],e(f,function(n,t){c(t)||(e(n.$options.services,function(n,i){f[n]&&(a[t][i].__proto__=f[n])}),d.debug&&console.log(t,a))})}var a={},l=[],p={},d=this,v=new u;this.install=function(t){var r={data:function(){return o(this.$options,"mixinModels")?{models:s}:{}},beforeCreate:function(){var n=this;e(f,function(t,i){c(i)||(n[i]=t)})},created:function(){!function(t){var o=t.$options.listen;i(o)?e(o,function(n,i){v.$on(n,function(){i.apply(t,arguments)})}):n(o)&&e(o,function(n){v.$on(n,function(){t[n].apply(t,arguments)})})}(this)}};t.mixin(r)},this.debug=!1,this.loaded=!1,this.mounted=!1,this.stop=!1,this.models=s,this.services=f,this.service=function(n,t,i){var e;if(i){e=i;var o=t.map(function(){return{}});o.push(s,{}),a[n]=o}else e=t,a[n]=[s,{}];(e=e.apply(this,a[n])).mixinModels=!0,i&&(e.services=t),h(n,e)},this.setModels=function(n){e(n,function(n,t){s[t]=n,l.push(t)})},this.replace=function(n,t){s[n]=t},this.rep=this.replace,this.relation=function(n,t,i){s[n]=o(s,t+"."+i)},this.rel=this.relation,this.call=v.$emit.bind(v),this.listen=v.$on.bind(v),this.BUS=v,v.call=v.$emit.bind(v),this.rootView=null,this.app=function(n,r){return e(p,function(n,o){var r=f[o];e(n,function(n,e){i(n)&&r.$watch(e,n.handler,{deep:n.deep}),t(n)&&r.$watch(e,n)})}),this.loaded=!0,!this.stop&&(this[n]=this.rootView=new u(r),o("el",r)&&(d.mounted=!0),{$mount:function(t){d[n].$mount(t),d.mounted=!0}})}}var f={},c=new Function;c.prototype=f;var h=new c;s.prototype=h;var a=new s(f,h);return u.use(a),a}return u});